const onBTRMessage=e=>{const t=e.data;if("BAT"===t.slice(0,3)){const e=t.slice(3),r=JSON.parse(e);if(batteryObj=r[0],console.log(batteryObj),batteryObj.cellsVoltage){let e=0;batteryObj.cellsVoltage.forEach((t,r)=>{refreshLevel(r,t/7,t),e+=t}),console.log(e.toFixed(3));const t=document.btrSt;t.cellSum.value.innerHTML=e.toFixed(3),t.balanceCap.value.innerHTML=batteryObj.BalanceCapacity+" Ah",t.rateCap.value.innerHTML=batteryObj.RateCapacity+" Ah",t.divVoltage.value.innerHTML=batteryObj.voltage+" Volts",t.divCurrent.value.innerHTML=batteryObj.current+" Ampers",t.divVoltDiff.value.innerHTML=(Math.max.apply(null,batteryObj.cellsVoltage)-Math.min.apply(null,batteryObj.cellsVoltage)).toFixed(3)+" V",document.querySelector("#chrgMosfetValue").checked=batteryObj.chargeMosfet,document.querySelector("#dsChrgMosfetValue").checked=batteryObj.dischargeMosfet,t.stateChrg.value.innerHTML=batteryObj.stateOfCharge,document.querySelector("body > div.content > div > div.ntcsStats").childNodes.forEach((e,t)=>{e.innerHTML=batteryObj.ntcs[t]+"&#176;C"})}let c=new Date(parseInt(batteryObj.currentTime+"000")),a=c.getHours();a<10&&(a="0"+a);let l=c.getMinutes();l<10&&(l="0"+l);let o=c.getSeconds();o<10&&(o="0"+o);const n=document.btrSt;n.currentTime.value.innerHTML=`${a}:${l}:${o}`,batteryObj.current>0?(document.querySelector("h1").innerHTML="CHARGING!!!",document.querySelectorAll(".acid-container > .acid").forEach(e=>{e.style.filter="hue-rotate(222deg)",document.querySelector("h1").classList.add("charging"),document.querySelector("h1").classList.remove("discharging")})):batteryObj.current<0?(document.querySelector("h1").innerHTML="DISCHARGING!!!",document.querySelectorAll(".acid-container > .acid").forEach(e=>{e.style.filter="hue-rotate(0deg)",document.querySelector("h1").classList.remove("charging"),document.querySelector("h1").classList.add("discharging")})):(document.querySelector("h1").classList.remove("discharging"),document.querySelector("h1").classList.remove("charging"),document.querySelector("h1").innerHTML="..idle",document.querySelectorAll(".acid-container > .acid").forEach(e=>{e.style.filter="hue-rotate(120deg)"}))}else console.log(t)};